<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TravelAI - Smart Itinerary Planner</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <i class="fas fa-plane-departure"></i>
                <span>TravelAI</span>
            </div>
            <div class="nav-menu">
                <a href="#home" class="nav-link active">Home</a>
                <a href="#dashboard" class="nav-link" style="display: none;">My Trips</a>
                <a href="#about" class="nav-link">About</a>
                <button id="authButton" class="auth-button" onclick="openAuthModal()">
                    <i class="fas fa-user"></i>
                    <span>Sign In</span>
                </button>
                <div id="userMenu" class="user-menu" style="display: none;">
                    <div class="user-info">
                        <i class="fas fa-user-circle"></i>
                        <span id="userEmail">user@example.com</span>
                    </div>
                    <button class="user-menu-btn" onclick="signOut()">
                        <i class="fas fa-sign-out-alt"></i>
                        Sign Out
                    </button>
                </div>
            </div>
            <div class="nav-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero">
        <div class="hero-background">
            <div class="hero-overlay"></div>
        </div>
        <div class="hero-content">
            <h1 class="hero-title">Plan Your Perfect Journey</h1>
            <p class="hero-subtitle">AI-powered travel wizard that creates personalized itineraries in under 60 seconds. Just answer a few questions and let Gemini AI do the rest.</p>
            <button class="cta-button" onclick="startWizard()">
                <span>Start AI Wizard</span>
                <i class="fas fa-magic"></i>
            </button>
            <div class="hero-actions">
                <button class="secondary-button" onclick="handleDashboardClick()">
                    <span>View My Trips</span>
                    <i class="fas fa-suitcase"></i>
                </button>
            </div>
        </div>
        <div class="hero-features">
            <div class="feature-card">
                <i class="fas fa-robot"></i>
                <h3>AI-Powered</h3>
                <p>Gemini AI creates personalized itineraries based on your preferences</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-clock"></i>
                <h3>60-Second Setup</h3>
                <p>Complete wizard in under a minute, even on 3G</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-edit"></i>
                <h3>Fully Editable</h3>
                <p>Drag, drop, and customize your AI-generated itinerary</p>
            </div>
        </div>
    </section>

    <!-- Wizard Section -->
    <section id="wizard" class="wizard-section hidden">
        <div class="container">
            <div class="wizard-container">
                <div class="wizard-header">
                    <h2>AI Travel Wizard</h2>
                    <p>Let's create your perfect trip in 7 simple steps</p>
                    <button class="skip-wizard" onclick="skipWizard()">
                        Skip wizard / Plan manually
                    </button>
                </div>

                <!-- Progress Bar -->
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-dots" id="progressDots">
                        <!-- Dots will be generated by JS -->
                    </div>
                    <div class="progress-text">
                        <span id="currentStep">1</span> of <span id="totalSteps">7</span>
                    </div>
                </div>

                <!-- Wizard Steps -->
                <div class="wizard-content">
                    <div class="wizard-step active" data-step="1">
                        <div class="step-content">
                            <h3>Where would you like to go?</h3>
                            <p>Choose your dream destination</p>
                            <div class="form-group">
                                <input type="text" id="destCountry" placeholder="Search countries or regions..." class="autocomplete-input">
                                <div class="autocomplete-suggestions" id="countrySuggestions"></div>
                            </div>
                        </div>
                    </div>

                    <div class="wizard-step" data-step="2">
                        <div class="step-content">
                            <h3>Where are you departing from?</h3>
                            <p>Your starting city or airport</p>
                            <div class="form-group">
                                <input type="text" id="departureCity" placeholder="Search cities or airports..." class="autocomplete-input">
                                <div class="autocomplete-suggestions" id="citySuggestions"></div>
                            </div>
                        </div>
                    </div>

                    <div class="wizard-step" data-step="3">
                        <div class="step-content">
                            <h3>When do you want to depart?</h3>
                            <p>Choose your departure date</p>
                            <div class="form-group">
                                <input type="date" id="startDate" class="date-input">
                            </div>
                        </div>
                    </div>

                    <div class="wizard-step" data-step="4">
                        <div class="step-content">
                            <h3>How long is your trip?</h3>
                            <p>Select the duration of your adventure</p>
                            <div class="form-group">
                                <div class="duration-controls">
                                    <input type="range" id="durationSlider" min="2" max="30" value="7" class="duration-slider">
                                    <input type="number" id="durationNumber" min="2" max="30" value="7" class="duration-number">
                                    <span class="duration-label">days</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="wizard-step" data-step="5">
                        <div class="step-content">
                            <h3>Who's traveling?</h3>
                            <p>Tell us about your travel companions</p>
                            <div class="form-group">
                                <div class="traveller-counters">
                                    <div class="counter-group">
                                        <label>Adults</label>
                                        <div class="counter">
                                            <button type="button" class="counter-btn" onclick="updateCounter('adults', -1)">-</button>
                                            <span id="adultsCount">1</span>
                                            <button type="button" class="counter-btn" onclick="updateCounter('adults', 1)">+</button>
                                        </div>
                                    </div>
                                    <div class="counter-group">
                                        <label>Kids</label>
                                        <div class="counter">
                                            <button type="button" class="counter-btn" onclick="updateCounter('kids', -1)">-</button>
                                            <span id="kidsCount">0</span>
                                            <button type="button" class="counter-btn" onclick="updateCounter('kids', 1)">+</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="wizard-step" data-step="6">
                        <div class="step-content">
                            <h3>Which cities would you like to visit?</h3>
                            <p>Select from AI-suggested destinations</p>
                            <div class="form-group">
                                <div class="loading-cities" id="loadingCities">
                                    <div class="spinner-small"></div>
                                    <span>Getting AI suggestions...</span>
                                </div>
                                <div class="cities-grid" id="citiesGrid">
                                    <!-- Cities will be populated by AI -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="wizard-step" data-step="7">
                        <div class="step-content">
                            <h3>What are your interests?</h3>
                            <p>Choose what excites you most (optional)</p>
                            <div class="form-group">
                                <div class="interests-grid">
                                    <div class="interest-chip" data-interest="beach">
                                        <i class="fas fa-umbrella-beach"></i>
                                        <span>Beach</span>
                                    </div>
                                    <div class="interest-chip" data-interest="culture">
                                        <i class="fas fa-landmark"></i>
                                        <span>Culture</span>
                                    </div>
                                    <div class="interest-chip" data-interest="food">
                                        <i class="fas fa-utensils"></i>
                                        <span>Food</span>
                                    </div>
                                    <div class="interest-chip" data-interest="adventure">
                                        <i class="fas fa-mountain"></i>
                                        <span>Adventure</span>
                                    </div>
                                    <div class="interest-chip" data-interest="relax">
                                        <i class="fas fa-spa"></i>
                                        <span>Relax</span>
                                    </div>
                                    <div class="interest-chip" data-interest="nightlife">
                                        <i class="fas fa-cocktail"></i>
                                        <span>Nightlife</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Wizard Navigation -->
                <div class="wizard-footer">
                    <button class="wizard-btn secondary" id="backBtn" onclick="previousStep()" disabled>
                        <i class="fas fa-arrow-left"></i>
                        Back
                    </button>
                    <button class="wizard-btn primary" id="nextBtn" onclick="nextStep()">
                        Next
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Dashboard Section -->
    <section id="dashboard" class="dashboard-section hidden">
        <div class="container">
            <div class="dashboard-header">
                <h2>My Trips</h2>
                <button class="create-trip-btn" onclick="startWizard()">
                    <i class="fas fa-plus"></i>
                    Create New Trip
                </button>
            </div>
            <div class="trips-grid" id="tripsGrid">
                <!-- Trips will be populated by JS -->
            </div>
        </div>
    </section>

    <!-- Trip Builder (Kanban) Section -->
    <section id="trip-builder" class="trip-builder-section hidden">
        <div class="container">
            <div class="trip-builder-header">
                <div class="trip-info">
                    <h2 id="tripTitle">Trip to Paris</h2>
                    <p id="tripDetails">7 days • 2 adults • Mar 15, 2024</p>
                </div>
                <div class="trip-actions">
                    <button class="action-btn" onclick="saveTrip()">
                        <i class="fas fa-save"></i>
                        Save
                    </button>
                    <button class="action-btn" onclick="shareTrip()">
                        <i class="fas fa-share"></i>
                        Share
                    </button>
                    <button class="action-btn" onclick="backToDashboard()">
                        <i class="fas fa-arrow-left"></i>
                        Back
                    </button>
                </div>
            </div>
            
            <div class="kanban-board" id="kanbanBoard">
                <!-- Kanban columns will be generated by JS -->
            </div>
        </div>
    </section>

    <!-- Loading Modal -->
    <div id="loadingModal" class="modal hidden">
        <div class="modal-content">
            <div class="loading-spinner">
                <div class="spinner"></div>
            </div>
            <h3>Creating Your Perfect Itinerary</h3>
            <p>Our AI is analyzing your preferences and crafting a personalized travel plan...</p>
            <div class="loading-steps">
                <div class="step active">
                    <i class="fas fa-search"></i>
                    <span>Analyzing destination</span>
                </div>
                <div class="step">
                    <i class="fas fa-map"></i>
                    <span>Planning routes</span>
                </div>
                <div class="step">
                    <i class="fas fa-star"></i>
                    <span>Finding attractions</span>
                </div>
                <div class="step">
                    <i class="fas fa-check"></i>
                    <span>Finalizing itinerary</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Confetti Canvas -->
    <canvas id="confetti" class="confetti-canvas"></canvas>

    <!-- Scripts -->
    <script src="js/supabase.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/wizard.js"></script>
    <script src="js/kanban.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/main.js"></script>
</body>
</html>